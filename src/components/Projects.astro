---
import type { CollectionEntry } from "astro:content";
import { Image } from "astro:assets";
import { cn } from "../lib/utils";
import ProjectLinks from "./ui/ProjectLinks.astro";

interface Props {
  projects: CollectionEntry<"pages">["data"]["projects"];
}

const { projects } = Astro.props;

console.dir(projects, { depth: null });
---

<section id="projects" class="bg-bg-base">
  <div class="w-full max-w-[1200px] mx-auto py-25 px-4">
    <h2
      class="text-2xl font-extrabold text-text-base tracking-wider relative after:content-[''] after:absolute after:left-0 after:-bottom-1 after:rounded-full after:w-8 after:h-1 after:bg-bg-secondary animate-fade-in-up mb-[70px]"
      data-animate
    >
      Projects
    </h2>
    <div class="flex flex-col gap-[70px]">
      {
        projects.map((project, index) => (
          <div
            class={cn(
              "flex relative",
              index % 2 === 0 ? "justify-start" : "justify-end"
            )}
          >
            <Image
              src={project.featured_image.url}
              alt={project.featured_image.alt}
              width={project.featured_image.width}
              height={project.featured_image.height}
              class="w-full md:w-[60%] h-auto"
            />
            <div
              class={cn(
                "absolute top-1/2 -translate-y-1/2",
                index % 2 === 0 ? "right-0" : "left-0",
                index % 2 === 0 ? "text-right" : "text-left"
              )}
            >
              {project.featured && (
                <span class="text-sm text-text-secondary block font-family-heading font-extrabold tracking-wider">
                  Featured Project
                </span>
              )}
              <a
                href={project.site || project.repo}
                class="text-lg font-extrabold text-text-base tracking-wider font-family-heading inline-block mb-2.5"
                target="_blank"
                rel="noopener noreferrer"
                data-analytics="project-link-click"
                data-label={project.site ? "site" : "repo"}
                data-href={project.site || project.repo}
              >
                {project.name}
              </a>
              <p class="text-sm text-text-base p-[27px] bg-[#E1D6CB] rounded-lg max-w-[533px]">
                {project.description}
              </p>
              <div
                class={cn(
                  "flex items-center gap-2.5 mt-2.5",
                  index % 2 === 0 ? "justify-end" : "justify-start"
                )}
              >
                {project.technologies.map((technology) => (
                  <span class="text-xs text-[#1F2A2E] font-bold tracking-wider">
                    {technology}
                  </span>
                ))}
              </div>
              <div
                class={cn(
                  "flex items-center gap-2.5 mt-2.5",
                  index % 2 === 0 ? "justify-end" : "justify-start"
                )}
              >
                {project.site && (
                  <ProjectLinks
                    class={index % 2 === 0 ? "order-1" : "order-2"}
                    icon="site"
                    href={project.site}
                  />
                )}
                {project.repo && (
                  <ProjectLinks
                    class={index % 2 === 0 ? "order-2" : "order-1"}
                    icon="repo"
                    href={project.repo}
                  />
                )}
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>
